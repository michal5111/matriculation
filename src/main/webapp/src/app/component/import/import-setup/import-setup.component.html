<div class="wrapper">
  <form [formGroup]="importCreationFormGroup" (ngSubmit)="onSubmit()">
    <mat-form-field class="form-field wide-field">
      <mat-label>Źródło danych</mat-label>
      <mat-select formControlName="dataSource" required="true"
                  (selectionChange)="onDataSourceSelectionChange($event)">
        <mat-option
          *ngFor="let dataSource of $availableDataSourcesObservable | async"
          [value]="dataSource.id">{{dataSource.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>

    <ng-template [ngIf]="dataSourceId.indexOf('FILE') >= 0">
      <mat-form-field class="form-field wide-field">
        <ngx-mat-file-input formControlName="dataFile" placeholder="Plik excel"
                            accept="application/vnd.ms-excel|application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"
                            multiple="false" [required]="dataSourceId.indexOf('FILE') >= 0">
        </ngx-mat-file-input>
        <mat-icon matSuffix>folder</mat-icon>
      </mat-form-field>
    </ng-template>

    <mat-form-field class="form-field wide-field">
      <mat-label>Rekrutacja</mat-label>
      <mat-select formControlName="registration" required="true"
                  (selectionChange)="onRegistrationSelectionChange($event)">
        <mat-option
          *ngFor="let registration of registrations"
          [value]="registration.id">{{registration.id}} {{registration.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <mat-form-field class="form-field wide-field">
      <mat-label>Program</mat-label>
      <mat-select formControlName="registrationProgramme" required="true"
                  (selectionChange)="onRegistrationProgrammeChange($event)">
        <mat-option
          *ngFor="let registrationProgramme of registrationProgrammes"
          [value]="registrationProgramme">{{registrationProgramme.name}}
        </mat-option>
      </mat-select>
    </mat-form-field>
    <div class="wide-wrapper">
      <mat-form-field class="form-field">
        <mat-label>Etap</mat-label>
        <mat-select formControlName="stage" required="true">
          <mat-option
            *ngFor="let stage of stages"
            [value]="stage">{{stage}}
          </mat-option>
        </mat-select>
      </mat-form-field>
      <mat-form-field class="form-field">
        <mat-label>Cykl dydaktyczny</mat-label>
        <input type="text" matInput formControlName="didacticCycle" [matAutocomplete]="auto" required="true">
        <button mat-button *ngIf="importCreationFormGroup.value.didacticCycle" matSuffix mat-icon-button
                aria-label="Clear" (click)="importCreationFormGroup.value.didacticCycle=''">
          <mat-icon>close</mat-icon>
        </button>
        <mat-autocomplete #auto="matAutocomplete">
          <mat-option *ngFor="let didacticCycle of didacticCycles" [value]="didacticCycle">
            {{didacticCycle}}
          </mat-option>
        </mat-autocomplete>
      </mat-form-field>
      <mat-form-field class="form-field">
        <mat-label>Pula indeksów</mat-label>
        <mat-select formControlName="indexPoolCode" required="true">
          <mat-option
            *ngFor="let indexPool of $indexPoolsObservable | async"
            [value]="indexPool.code">{{indexPool.description}}
          </mat-option>
        </mat-select>
      </mat-form-field>
    </div>
    <div>
      <mat-form-field class="form-field form-field-date">
        <mat-label>Data rozpoczęcia studiów</mat-label>
        <input matInput [matDatepicker]="startDatePicker" formControlName="startDate" required="true">
        <mat-datepicker-toggle matSuffix [for]="startDatePicker"></mat-datepicker-toggle>
        <mat-datepicker #startDatePicker></mat-datepicker>
      </mat-form-field>
      <mat-form-field class="form-field form-field-date">
        <mat-label>Data przyjęcia na program</mat-label>
        <input matInput [matDatepicker]="dateOfAddmisionPicker" formControlName="dateOfAddmision" required="true">
        <mat-datepicker-toggle matSuffix [for]="dateOfAddmisionPicker"></mat-datepicker-toggle>
        <mat-datepicker #dateOfAddmisionPicker></mat-datepicker>
      </mat-form-field>
    </div>
    <button mat-button type="submit" [disabled]="!importCreationFormGroup.valid">
      <mat-icon>add</mat-icon>
      Utwórz
    </button>
  </form>
</div>
